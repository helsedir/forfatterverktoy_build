<div class="modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" ng-click="close('Cancel')" data-dismiss="modal" aria-hidden="true">&times;</button>
        <div class="col-md-4">
                  <h4 class="modal-title">Velg referanse</h4>
                </div>
                <div class="form-group col-md-5 searchboxmodal pull-right">
                        <div class="input-group">
                            <input id="search" ng-model="searchText" class="form-control">
                            <div class="input-group-addon">
                                <span class="glyphicon glyphicon-search"></span>
                            </div>
                        </div>
                    </div>
              </div>
      <div class="modal-body">
        
        <table class="table  table-pointer" >
          <thead>
            <tr>
              <th>Referanse</th>
              <th>Velg</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="reference in references | filter:searchText | orderBy: 'author'" ng-class="{success: reference.checked}">
              <td ng-click="reference.checked = !reference.checked"><span ng-if="reference.author">{{reference.author}}. </span><span ng-if="reference.title">{{reference.title}}. </span> <span ng-if="reference.journal">{{reference.journal}}. </span> <span ng-if="reference.year">{{reference.year}}</span><span ng-if="reference.volume">;{{reference.volume}}</span><span ng-if="reference.issue">({{reference.issue}})</span><span ng-if="reference.pageStart">:{{reference.pageStart}}</span><span ng-if="reference.pageEnd">-{{reference.pageEnd}}. </span><span ng-if="reference.pmid">PubMed PMID: {{reference.pmid}}. </span> <span ng-if="reference.url" class="breakall">Avaliable from: {{reference.url}} </span></td>
              <td>
                <input type="checkbox" ng-model="reference.checked">
              </td>
              
            </tr>
          </tbody>
        </table>

        <button type="button" class="btn btn-secondary pull-right" ng-click="openCreateReference()" aria-hidden="true">Opprett ny referanse <span ng-class="{ 'glyphicon-chevron-up': !isCollapsed, 'glyphicon-chevron-down': isCollapsed}" class="glyphicon"></span></button>
        <br><br><br>

          <div collapse="isCollapsed">
            <div class="well overflowhidden">
              <div class="panel panel-default">
                  <div class="panel-heading"> 
                      Forhåndsvisning av referanse
                  </div>
                  <div class="panel-body referencepreview">
                      <span ng-if="reference.author">{{reference.author}}. </span><span ng-if="reference.title">{{reference.title}}. </span> <span ng-if="reference.journal">{{reference.journal}}. </span> <span ng-if="reference.year">{{reference.year}}</span><span ng-if="reference.volume">;{{reference.volume}}</span><span ng-if="reference.issue">({{reference.issue}})</span><span ng-if="reference.pageStart">:{{reference.pageStart}}</span><span ng-if="reference.pageEnd">-{{reference.pageEnd}}. </span><span ng-if="reference.pmid">PubMed PMID: {{reference.pmid}}. </span> <span ng-if="reference.url" class="breakall">Available from: {{reference.url}} </span>
                  </div>
              </div>
              
              <form role="form" ng-submit="saveReference()">
                  <div class="form-group">
                      <label for="author">Forfatter</label>
                      <input type="text" class="form-control" id="author" ng-model="reference.author" required>
                  </div>
                  <div class="form-group">
                      <label for="title">Tittel</label>
                      <input type="text" class="form-control" id="title" ng-model="reference.title">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="journal">Navn på tidsskrift</label>
                      <input type="text" class="form-control" id="journal" ng-model="reference.journal">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="year">År</label>
                      <input type="text" class="form-control" id="year" ng-model="reference.year">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="volume">volume</label>
                      <input type="text" class="form-control" id="volume" ng-model="reference.volume">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="issue">issue</label>
                      <input type="text" class="form-control" id="issue" ng-model="reference.issue">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="pageStart">Sidenummer start</label>
                      <input type="text" class="form-control" id="pageStart" ng-model="reference.pageStart">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="pageEnd">Sidenummer slutt</label>
                      <input type="text" class="form-control" id="pageEnd" ng-model="reference.pageEnd">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="pmid">Pmid</label>
                      <input type="text" class="form-control" id="pmid" ng-model="reference.pmid">
                  </div>
                  <div class="form-group col-sm-6">
                      <label for="url">Url</label>
                      <input type="text" class="form-control" id="url" ng-model="reference.url">
                  </div>
                  <div class="pull-right">
                    <button type="submit" class="btn btn-primary">Lagre referanse</button>
                  </div>
              </form>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" aria-hidden="true">Avbryt</button>
        <button type="button" class="btn btn-primary" ng-click="save()" data-dismiss="modal" ng-class="{disabled: !isCollapsed}"  aria-hidden="true">Lagre</button>
      </div>
    </div>
  </div>
</div>